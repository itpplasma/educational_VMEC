#!/usr/bin/env python3
"""Compare axis guessing results between educational_VMEC and VMEC++."""

print("=== AXIS GUESSING COMPARISON ===")
print("=" * 80)

print("\n1. GRID SEARCH PARAMETERS:")
print("-" * 40)
print("Educational_VMEC:")
print("  Grid resolution: 61 points")
print("  Plane 0: rmin=5.272  rmax=6.965")
print("          zmin=-0.598 zmax=0.598")
print("  Initial guess: rcom=6.119 zcom=0.000")
print("")
print("VMEC++:")
print("  Grid resolution: 61 points")
print("  Plane 0: rmin=0.000  rmax=6.965")
print("          zmin=-0.268 zmax=0.598")
print("  Initial guess: rcom=3.483 zcom=0.165")

print("\n2. KEY DIFFERENCES:")
print("-" * 40)
print("a) R-bounds:")
print("   - Educational_VMEC: rmin = 5.272 (reasonable for a tokamak)")
print("   - VMEC++:           rmin = 0.000 (UNREALISTIC!)")
print("")
print("b) Z-bounds:")
print("   - Educational_VMEC: symmetric around z=0 (-0.598 to 0.598)")
print("   - VMEC++:           asymmetric (-0.268 to 0.598)")
print("")
print("c) Initial axis guess:")
print("   - Educational_VMEC: R=6.119 (center of [5.272, 6.965])")
print("   - VMEC++:           R=3.483 (center of [0.000, 6.965])")

print("\n3. FINAL AXIS POSITIONS:")
print("-" * 40)
print("Educational_VMEC:")
print("  Plane 0: rcom=6.119 zcom=0.120")
print("  Final R=6.039 Z=0.078 (converged after 1214 iterations)")
print("")
print("VMEC++:")
print("  Plane 0: new_r_axis=3.483 new_z_axis=0.006")
print("  FAILS with BAD_JACOBIAN")

print("\n4. ROOT CAUSE ANALYSIS:")
print("-" * 40)
print("The critical issue is that VMEC++ computes rmin=0.000, which is")
print("physically wrong for a tokamak. This leads to:")
print("")
print("1. Wrong axis guess: R=3.483 (way too small for tokamak)")
print("2. The axis search can't find a valid position because the")
print("   search region includes R=0, which has singular geometry")
print("")
print("Educational_VMEC correctly computes rmin=5.272, avoiding the")
print("singular region near R=0 and finding a valid axis at R~6.0")

print("\n5. NEXT DEBUGGING STEP:")
print("-" * 40)
print("Need to trace why VMEC++ computes rmin=0 for the LCFS boundary.")
print("This likely involves the boundary Fourier transform or evaluation.")